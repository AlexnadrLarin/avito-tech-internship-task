# avito-tech-internship-task

## Описание

Тестовое задание Avito Tech Internship для вакансии Backend-разработчик.  
Выполнил Ларин Александр. \

##  Инструкция по запуску
1. Создайте файл `.env`, скопировав и заполнив значения из примера `.env.example`:

   ```bash 
   cp .env.example .env
   ```
   При использовании данных из примера проект также будет запускаться.
2. Запустите приложение:
    ```bash 
    docker compose --env-file .env up
    ```
    Это сделано для того, чтобы не хранить на Git важные данные и чтобы избежать хардкода в compose файлах. 
3. Приложение будет доступно по адресу:
   ```
   http://localhost:8080
   ```
   Все эндпоинты находятся под префиксом `/api/v1/...`.

## Дополнительные задания

### Эндпоинт для статистики
Статистику по назначениям пользователей на ревью можно получить по эндпоинту:
```
http://localhost:8080/api/v1/users/getReviewsStats
```
Выводятся ID пользователей и количество ревью.

### Интеграционное тестирование
Для запуска интеграционного тестирования нужно воспользоваться командой:
```bash 
docker compose -f docker-compose.e2e.yml --env-file .env up
```
Unit-тесты запускаются при сборке Dockerfile pull-request-service.

### Нагрузочное тестирование
Для запуска нагрузочного тестирования нужно воспользоваться командой:
```bash 
docker compose -f docker-compose.ab.yml --env-file .env up
```
### Результаты тестирования
| Эндпоинт                 | Тип нагрузки | Запросов | Параллельность | Среднее время (ms) | RPS (зап/с) | Ошибки |
| ------------------------ | ------------ | -------- | -------------- | ------------------ | ----------- | ------ |
| `/team/add`              | запись       | 18 000   | 1 200          | 110                | 10 879      | 0      |
| `/team/get`              | чтение       | 33 000   | 2 000          | 177                | 11 323      | 0      |
| `/users/setIsActive`     | запись       | 18 000   | 1 200          | 106                | 11 292      | 0      |
| `/pullRequest/create`    | запись       | 18 000   | 1 200          | 107                | 11 171      | 0      |
| `/pullRequest/merge`     | запись       | 18 000   | 1 200          | 112                | 10 704      | 0      |
| `/pullRequest/reassign`  | запись       | 18 000   | 1 200          | 108                | 11 126      | 0      |
| `/users/getReview`       | чтение       | 42 000   | 2 600          | 230                | 11 304      | 0      |
| `/users/getReviewsStats` | агрегация    | 48 000   | 3 000          | 254                | 11 810      | 0      |

Использовал Apache Benchmark через CLI утилиту ab, что описано Makefile. 